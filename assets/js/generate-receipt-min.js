class formControls{constructor(){this["renter-name"]=document.getElementById("renter-name"),this.rent=document.getElementById("rent"),this.address=document.getElementById("address"),this["landlord-name"]=document.getElementById("landlord-name"),this["landlord-pan"]=document.getElementById("landlord-pan"),this["date-from"]=document.getElementById("date-from"),this["date-to"]=document.getElementById("date-to"),this["receipt-month"]=document.querySelectorAll("[name='receipt-month']"),this["download-pdf"]=document.getElementById("download-pdf"),this["form-control"]=document.querySelectorAll(".form-control"),this["spinner-grow"]=document.querySelector(".spinner-grow"),this["download-text"]=document.querySelector(".download-text"),this["select-template"]=document.querySelector(".select-template")}}let objFormControls={},objErrorControls={},objTemplateControls={},date=new Date;var readyPage=()=>{for(let e in objTemplateControls={receipts:document.getElementById("receipts"),"generate-date":document.querySelectorAll(".generate-date"),"current-month":document.querySelectorAll(".current-month"),"receipt-number":document.querySelectorAll(".receipt-number")},objFormControls=new formControls)document.querySelector("p[data-error="+e+"]")&&(objErrorControls[e]=document.querySelector("p[data-error="+e+"]")),document.querySelector("[data-tm="+e+"]")&&(objTemplateControls[e]=document.querySelectorAll("[data-tm="+e+"]"));objFormControls["date-from"].value=date.toISOString().substring(0,10),objFormControls["date-to"].value=date.toISOString().substring(0,10)};readyPage(),objFormControls["form-control"].forEach(function(e){["keyup","change"].forEach(function(t){e.addEventListener(t,function(){document.querySelectorAll("."+e.id).forEach(t=>{t.innerHTML=e.value})})})});var getMonthShortName=e=>{var t;return new Date(e).toLocaleString("default",{month:"long",year:"numeric"})},addMonths=(e,t,r)=>{Date.isLeapYear=function(e){return e%4==0&&e%100!=0||e%400==0},Date.getDaysInMonth=function(e,t){return[31,Date.isLeapYear(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]},Date.prototype.isLeapYear=function(){return Date.isLeapYear(this.getFullYear())},Date.prototype.getDaysInMonth=function(){return Date.getDaysInMonth(this.getFullYear(),this.getMonth())},Date.prototype.addMonths=function(e){var t=this.getDate();return this.setDate(1),this.setMonth(this.getMonth()+e),this.setDate(Math.min(t,this.getDaysInMonth())),this};var o,n=new Date(e),a=new Date(t),l=[],s=new Date(n),d=!1,i=s.addMonths(r);if(o=new Date(i),i.setDate(i.getDate()-1),a<=o?(l[0]={start:n,end:a},d=!1):(l[0]={start:n,end:i},d=!0),d)for(let m=1;l[l.length-1].end<a;m++){let c=new Date(o);var i=(s=new Date(o)).addMonths(r);o=new Date(i),i.setDate(i.getDate()-1),a<=o?l[m]={start:c,end:a}:l[m]={start:c,end:i}}var p={year:"numeric",month:"short",day:"numeric"};return l.forEach((e,t,r)=>{r[t]={start:e.start.toLocaleDateString("en-US",p),end:e.end.toLocaleDateString("en-US",p)}}),l},checkValidation=(e,t,r,o)=>{if("Name"==t){var n=/\d/g,a=/\W/g;return""==e?(o(!1,r+" cannot be  empty!"),!1):e.length>35?(o(!1,r+" cannot be more than 35 characters!"),!1):n.test(e)?(o(!1,r+" cannot contain numbers and space!"),!1):(o(!0,r+" validated successfull!"),!0)}if("Empty"==t)return""==e?(o(!1,r+" cannot be empty!"),!1):(o(!0,r+" validated successfull!"),!0)},addDynamicData=e=>{let t=!0,r,o;checkValidation(objFormControls["renter-name"].value,"Name","Name",function(e,t){e?objErrorControls["renter-name"].style.display="none":(objErrorControls["renter-name"].innerHTML=t,objErrorControls["renter-name"].style.display="block")}),checkValidation(objFormControls.rent.value,"Empty","Rent",function(e,t){e?objErrorControls.rent.style.display="none":(objErrorControls.rent.innerHTML=t,objErrorControls.rent.style.display="block")}),checkValidation(objFormControls.address.value,"Empty","Address",function(e,t){e?objErrorControls.address.style.display="none":(objErrorControls.address.innerHTML=t,objErrorControls.address.style.display="block")}),checkValidation(objFormControls["landlord-name"].value,"Name","Owner's name",function(e,t){e?objErrorControls["landlord-name"].style.display="none":(objErrorControls["landlord-name"].innerHTML=t,objErrorControls["landlord-name"].style.display="block")});let n=document.getElementsByClassName("validation-message");if(Object.keys(n).some(function(e){if("block"==n[e].style.display){r="pdfAddressError"==n[e].id?130:80;var r,o=n[e].getBoundingClientRect().top+window.pageYOffset-r;return window.scrollTo({top:o,behavior:"smooth"}),n[e].previousElementSibling.focus(),t=!1,!0}}),t){r=objFormControls["date-from"].value,o=objFormControls["date-to"].value;let a=document.getElementById("monthly"),l=1;a.checked||(l=3);let s=addMonths(r,o,l),d=new Date().toString();d=d.slice(4,15),s.forEach((e,t,r)=>{if(1==r.length)objTemplateControls["date-from"][0].innerHTML=e.start.toUpperCase(),objTemplateControls["date-to"][0].innerHTML=e.end.toUpperCase(),objTemplateControls["current-month"][0].innerHTML=getMonthShortName(e.start),objTemplateControls["receipt-number"][0].innerHTML="1",objTemplateControls["generate-date"][0].innerHTML=getMonthShortName(d);else if(0==t)objTemplateControls["date-from"][0].innerHTML=e.start.toUpperCase(),objTemplateControls["date-to"][0].innerHTML=e.end.toUpperCase(),objTemplateControls["current-month"][0].innerHTML=getMonthShortName(e.start),objTemplateControls["receipt-number"][0].innerHTML="1",objTemplateControls["generate-date"][0].innerHTML=getMonthShortName(d);else{var o,n=document.getElementById("invoice1").cloneNode(!0);if(n.id="invoice"+(t+1),objTemplateControls.receipts.appendChild(n),document.querySelector("#invoice"+(t+1)+" [data-tm='date-from']").innerHTML=e.start.toUpperCase(),document.querySelector("#invoice"+(t+1)+" [data-tm='date-to']").innerHTML=e.end.toUpperCase(),document.querySelector("#invoice"+(t+1)+"  .current-month").innerHTML=getMonthShortName(e.start),document.querySelector("#invoice"+(t+1)+"  .receipt-number").innerHTML=t+1,document.querySelector("#invoice"+(t+1)+"  .generate-date").innerHTML=getMonthShortName(d),(t+1)%3==0&&0!=t){generateAdd();let a=document.createElement("div");a.setAttribute("class","html2pdf__page-break"),objTemplateControls.receipts.appendChild(a)}}(t+1)%3!=0&&t+1==r.length&&generateAdd()}),e(!0,"validation done.")}else e(!1,"validation not done.")},resetPage=e=>{objFormControls["spinner-grow"].style.display="none",objFormControls["download-text"].innerHTML="Download";let t=document.getElementsByClassName("invoice");for(;t.length>1;)t[1].parentNode.removeChild(t[1]);let r=document.getElementsByClassName("html2pdf__page-break");for(;r.length>0;)r[0].parentNode.removeChild(r[0]);let o=document.getElementsByClassName("page-add");for(;o.length>0;)o[0].parentNode.removeChild(o[0])},generateAdd=()=>{let e=document.createElement("div");e.setAttribute("class","page-add"),e.innerHTML="Generated by https://www.generatereceipt.blogspot.com",objTemplateControls.receipts.appendChild(e)},generatePDF=()=>{addDynamicData((e,t)=>{if(e){objFormControls["spinner-grow"].style.display="inline-block",objFormControls["download-text"].innerHTML="PDF Generating...";let r=document.getElementById("receipts");var o={jsPDF:{format:"a4",orientation:"portrait"},html2canvas:{letterRendering:!0,useCORS:!0,logging:!0,scrollX:0,scrollY:0},margin:[0,-3.5,0,0],padding:0,image:{type:"jpeg",quality:.98}};html2pdf().set(o).from(r).toPdf().save("Rent receipt by Generate Receipt").then(e=>{resetPage(),gtag("event","PDF download",{eventCategory:"category_value",dimension5:"custom data"})}).catch(e=>{console.log("PDF Error "+e)})}})};objFormControls["download-pdf"].addEventListener("click",()=>{generatePDF()});